Trend Micro Cyber Safety Solutions Team <TIMESTAMP>March</TIMESTAMP> 7, 2019
<MITRE_ATTACK>malware</MITRE_ATTACK> that piqued our interest in multiple ways.
infection was done by exploiting <CVE>CVE-2018-8174</CVE>, a
VBScript engine vulnerability that was patched by Microsoft back in <TIMESTAMP>May</TIMESTAMP> 2018.
Second, it uses a multi-stage infection scheme. After it <MITRE_ATTACK>exploits</MITRE_ATTACK> the vulnerability, it
downloads a DLL and runs it in <MITRE_ATTACK>PowerShell</MITRE_ATTACK> (PS). This file, which is a downloader, then
downloader also checks for the existence of different kinds of antivirus <MITRE_ATTACK>software</MITRE_ATTACK>
processes, and then proceeds to exit if any is found. <MITRE_ATTACK>At</MITRE_ATTACK> the time of <MITRE_ATTACK>discovery</MITRE_ATTACK>, the
In addition to the previously mentioned facts, we quickly noticed that the <MITRE_ATTACK>malware</MITRE_ATTACK>
any <MITRE_ATTACK>malware</MITRE_ATTACK> to date that communicates using Slack– although we’ve previously
Note that as soon as this <MITRE_ATTACK>malware</MITRE_ATTACK> was discovered, we informed the Canadian Centre
for Cyber Security, which acts as <COUNTRY>Canada</COUNTRY>’s National Computer Security Incident
understand the <MITRE_ATTACK>malware</MITRE_ATTACK> that was found, and offered mitigation advice.
https://nvd.nist.gov/vuln/detail/<CVE>CVE-2018-8174</CVE>
https://blog.trendmicro.com/trendlabs-security-intelligence/microsoft-patch-tuesday-for-may-includes-updates-for-actively-exploited-<MITRE_ATTACK>vulnerabilities</MITRE_ATTACK>-2/
The downloader, which runs through <MITRE_ATTACK>PowerShell</MITRE_ATTACK> as a DLL, serves several purposes.
The first is to download the second stage <MITRE_ATTACK>malware</MITRE_ATTACK>, which we called the SLUB (for
Finally, the downloader also <MITRE_ATTACK>exploits</MITRE_ATTACK> the <CVE>CVE-2015-1701</CVE> vulnerability to acquire Local
<MITRE_ATTACK>Privilege Escalation</MITRE_ATTACK>. The exploit’s code was likely created by modifying code from a
https://github.com/hfiref0x/<CVE>CVE-2015-1701</CVE>/blob/master/<MITRE_ATTACK>Source</MITRE_ATTACK>/Taihou/main.c
The <MITRE_ATTACK>malware</MITRE_ATTACK> also embeds two authorization tokens to communicate with the Slack
It copies itself to ProgramData\update\ and creates <MITRE_ATTACK>persistence</MITRE_ATTACK> via a Run
registry key, calling export function UpdateMPUnits with <MITRE_ATTACK>rundll32</MITRE_ATTACK>.exe. Note the
exec Execute command with <MITRE_ATTACK>cmd</MITRE_ATTACK>.exe
destroy Delete <MITRE_ATTACK>malware</MITRE_ATTACK> from disk with a batch script
<MITRE_ATTACK>reg</MITRE_ATTACK>
Query <MITRE_ATTACK>Query registry</MITRE_ATTACK> key
on <TIMESTAMP>February</TIMESTAMP> 19 and 20, while we estimate that the attacker compiled the <MITRE_ATTACK>malware</MITRE_ATTACK> on
<TIMESTAMP>February</TIMESTAMP> 22.
The attacker added the first commands to Github on <TIMESTAMP>February</TIMESTAMP> 20. However looking <MITRE_ATTACK>at</MITRE_ATTACK>
the Slack channels, we can see that the attacker tested the <MITRE_ATTACK>malware</MITRE_ATTACK> on <TIMESTAMP>February</TIMESTAMP> 23
and 24. The first victims were seen on <TIMESTAMP>February</TIMESTAMP> 27.
^exec,<MITRE_ATTACK>tasklist</MITRE_ATTACK>$
^<MITRE_ATTACK>reg</MITRE_ATTACK>,read,HKEY_CURRENT_USER,<MITRE_ATTACK>SOFTWARE</MITRE_ATTACK>\\Microsoft\\Windows\\CurrentVersion\\Run$
all users, and check the <MITRE_ATTACK>malware</MITRE_ATTACK>’s <MITRE_ATTACK>persistence</MITRE_ATTACK> registry key.
^exec,<MITRE_ATTACK>powershell</MITRE_ATTACK> -Command compress-archive -path C:\Users\USER\Desktop -
We also noted a specific interest in a <MITRE_ATTACK>software</MITRE_ATTACK> called “Neologic Plus Board,” which
indication that the attackers either developed the <MITRE_ATTACK>malware</MITRE_ATTACK> or got it from a private
information, with a special focus on communication <MITRE_ATTACK>software</MITRE_ATTACK>, in an attempt to learn
any <MITRE_ATTACK>domains</MITRE_ATTACK> or anything else that could leave a trail. The few <MITRE_ATTACK>email addresses</MITRE_ATTACK> we
their <MITRE_ATTACK>malware</MITRE_ATTACK>.
of another third party’s computer using <MITRE_ATTACK>malware</MITRE_ATTACK>, and reported to us the existence of a
