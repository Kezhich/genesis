analysis and the earliest one could trace back to <TIMESTAMP>July</TIMESTAMP> 2018. The relevant accounts were still in use when the report was completed.
The related attack vector is an XLSM file, created on <TIMESTAMP>August</TIMESTAMP> 8 and uploaded to VT on <TIMESTAMP>August</TIMESTAMP> 13, that leverages <CVE>CVE-2017-11882</CVE> vulnerability to release
<MITRE_ATTACK>MSBuild</MITRE_ATTACK>.exe to the %AppData% directory and then add registry Run key to stay persistent. To obtain C2 address, it reads data from Github and Feed43 where
The sample was uploaded to VT <MITRE_ATTACK>at</MITRE_ATTACK> 5:05 on <TIMESTAMP>Aug</TIMESTAMP> 13, 2019 with below details:
Name <COUNTRY>India</COUNTRY> makes Kashmir Dangerous Place in the World.xlsm
After opening, a blurred picture shows up to lure the victim to enable macro. After that, a clear picture titled "<COUNTRY>India</COUNTRY> has made Kashmir the most dangerous place
1.Correct the MZ header located <MITRE_ATTACK>at</MITRE_ATTACK> offset 0x558 of the shellcode entry point (add “MZ”)
2.Drop the PE file to "%AppData%\<MITRE_ATTACK>MSBuild</MITRE_ATTACK>.exe".
3.Add registry run key (key value: lollipop) to make "%AppData%\<MITRE_ATTACK>MSBuild</MITRE_ATTACK>.exe" persistent.
<MITRE_ATTACK>MSBuild</MITRE_ATTACK>.exe Analysis
<MITRE_ATTACK>MSBuild</MITRE_ATTACK>.exe is released to the %AppData% directory, and the compilation time is <TIMESTAMP>August</TIMESTAMP> 8th, 2019 which coincides with the XML creation time on Github that
Name <MITRE_ATTACK>MSBuild</MITRE_ATTACK>.exe
After the malicious code is executed, it will “sleep” for a period of time. This is implemented by executing function in a loop for 80,000 times, to delay <MITRE_ATTACK>execution</MITRE_ATTACK>
<MITRE_ATTACK>Source</MITRE_ATTACK> Decrypted Content
The Github account used by the attacker is created on <TIMESTAMP>August</TIMESTAMP> 7th, 2019, which matches the compilation time of the sample:
The decrypted C2 address is 139.28.38.236 and the <MITRE_ATTACK>malware</MITRE_ATTACK> uses HTTP/HTTPS in network communication:
<COUNTRY>cn</COUNTRY> Computer name
ver <MITRE_ATTACK>Malware</MITRE_ATTACK> version, here it is 1.0
After that the <MITRE_ATTACK>malware</MITRE_ATTACK> enters a while loop, to perform actions according to HTTP response:
23 Upload <MITRE_ATTACK>screen capture</MITRE_ATTACK> file
The attacker uploads the files generated after executing remote commands to the C&C <MITRE_ATTACK>server</MITRE_ATTACK>. The following table is a comparison table of the cached files
TPX499.dat <MITRE_ATTACK>Screen capture</MITRE_ATTACK> file
The <MITRE_ATTACK>malware</MITRE_ATTACK> collects a list of files with specific suffixes, stores them in a local file, and uploads to the C2 <MITRE_ATTACK>server</MITRE_ATTACK>:
extracted for investigation. From the time of file creation, the attacker started working <MITRE_ATTACK>at</MITRE_ATTACK> least as early as <TIMESTAMP>July</TIMESTAMP> 2018. The earliest created account was on <TIMESTAMP>July</TIMESTAMP>
3, 2018, and continued to <TIMESTAMP>August</TIMESTAMP> 2019 when the document was completed. In terms of the statistics of monthly creations, the number of creations in <TIMESTAMP>July</TIMESTAMP> 2018
The attacker may conduct a concentrated attack from <TIMESTAMP>July</TIMESTAMP> to <TIMESTAMP>September</TIMESTAMP> in 2018.
completed by multiple attackers considering the different names being used. Many IDs can be found on <MITRE_ATTACK>social media</MITRE_ATTACK>, and most of them are located in
<COUNTRY>India</COUNTRY> and <COUNTRY>Pakistan</COUNTRY>:
Most of the C2s are located in <COUNTRY>Ukraine</COUNTRY> while there are 2 IPs in <COUNTRY>China</COUNTRY>:
In the perspective of cyber wars, the conflict between <COUNTRY>India</COUNTRY> and <COUNTRY>Pakistan</COUNTRY> over the territory of Kashmir has lasted for decades, which makes it a perfect topic in
target attacks. For example, Donot and Bitter disguised as Kashmiri Voice to attack <COUNTRY>Pakistan</COUNTRY>, Transparent Tribe attacked <COUNTRY>India</COUNTRY> with decoy document regarding
<COUNTRY>India</COUNTRY>’s attempt to abolish <COUNTRY>India</COUNTRY>-controlled Kashmir is to detonate the conflict between the two countries. The two sides exchanged fire and some soldiers have
attacks against <COUNTRY>China</COUNTRY>, we must take actions in advance and keep a close eye on their recent activities.
